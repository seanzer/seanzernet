<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>
    <button onclick="smoothScroll();">Smooth Scroll</button>

    <div id="viewport" style="width:500px;height: 500.45px;overflow:scroll;-ms-scroll-snap-type: mandatory; -ms-scroll-snap-points-y: snapInterval(0%, 500.45px);">
        <div id="surface" style="width:100%; height: 100000px;"></div>
    </div>

    <div id="console" style="overflow:auto;"></div>
    <script>
        var console = document.querySelector("#console");
        window.output = function output_f(msg) {
            console.innerHTML = msg + "<br />" + console.innerHTML;
        };

        window.MSManipulationStateChangedHandler = function pivot_MSManipulationStateChangedHandler(ev) {
            this._currentManipulationState = ev.currentState;
            if (this._currentManipulationState === MSManipulationEvent.MS_MANIPULATION_STATE_INERTIA) {
                var destinationY = ev.inertiaDestinationY;
                output("destinationY: " + destinationY);
            }
        };

        var viewport = document.querySelector("#viewport");
        window.smoothScroll = function smoothScroll_f() {
            viewport.scrollTop = 0;
            var destinationY = viewport.scrollTop + parseFloat(getComputedStyle(viewport).height);
            output("zoomTo destinationY: " + destinationY);
            viewport.msZoomTo({ contentY: destinationY, contentX: 0, viewportX: 0, viewportY: 0 });
        };

        viewport.addEventListener("MSManipulationStateChanged", MSManipulationStateChangedHandler);
        viewport.addEventListener("scroll", function () {
            output("scrollTop: " + viewport.scrollTop);
        });
    </script>
</body>
</html>